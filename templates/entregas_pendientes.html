{% extends "base.html" %}

{% block title %}Entregas Pendientes{% endblock %}

{% block head_extra %}
{{ super() }}

{% endblock %}

{% block content %}
<h1 class="mb-4 text-white border-bottom pb-2" style="font-weight: 500;">
  <i class="bi bi-truck me-2 text-success"></i>Entregas Pendientes
</h1>

<div class="container px-0">
  {% if entregas %}
  {% for fecha, pedidos in entregas.items() %}
  <!-- Cabecera de fecha en estilo "tarjeta" -->
  <div class="entrega-fecha-header">
    <i class="bi bi-calendar-event me-2 text-primary"></i>
    Fecha de Entrega: {{ fecha }}
  </div>

  <!-- Tabla dentro de wrapper con bordes igual al resumen -->
  <div class="table-responsive entrega-table-wrapper mb-4">
    <table class="table table-dark table-bordered align-middle mb-0">
      <!-- Fijamos anchos para que no se mueva -->
      <colgroup>
        <col style="width:60%">
        <col style="width:15%">
        <col style="width:25%">
      </colgroup>
      <thead class="table-secondary text-dark">
        <tr>
          <th>Cliente</th>
          <th>Items</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for pedido in pedidos %}
        <tr>
          <td>
            <a href="{{ url_for('entregas.remito', id_pedido=pedido.id_pedido) }}"
              class="btn btn-sm btn-outline-success d-inline-flex align-items-center"
              style="font-size: 0.85rem; padding: 0.3rem 0.8rem;">
              <i class="bi bi-file-earmark-text me-1"></i> Generar Remito
            </a>

            <form action="{{ url_for('entregas.cancelar_pedido', id_pedido=pedido.id_pedido) }}" method="POST"
              style="display:inline;" onsubmit="return confirm('¿Estás seguro de cancelar este pedido?')">
              <button type="submit" class="btn btn-sm btn-outline-danger d-inline-flex align-items-center ms-1"
                style="font-size: 0.85rem; padding: 0.3rem 0.8rem;">
                <i class="bi bi-x-circle me-1"></i> Cancelar Pedido
              </button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% endfor %}
  {% else %}
  <p class="alert alert-info">No hay entregas pendientes.</p>
  {% endif %}
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
{% endblock %}