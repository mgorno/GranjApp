<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Visor PDF Remito #{{ id_remito }}</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #visor { width: 100%; height: 80vh; border: 1px solid #ccc; }
        .botones { margin-top: 10px; }
        button, a.btn { 
            margin-right: 10px; 
            padding: 10px 15px; 
            cursor: pointer; 
            text-decoration: none; 
            color: #000;
            background: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h2>Visor de Remito #{{ id_remito }}</h2>
    <iframe
      id="visor"
      src="{{ url_for('entregas.remito_pdf', id_remito=id_remito) }}"
      frameborder="0"
    ></iframe>

    <div class="botones">
        <button onclick="document.getElementById('visor').contentWindow.print()">
          üñ®Ô∏è Imprimir
        </button>

        <button onclick="enviarPorWhatsapp()">
          üì§ Enviar por WhatsApp
        </button>

        <!-- Volver a entregas, no window.close() -->
        <a href="{{ url_for('entregas.lista_entregas') }}" class="btn">
          ‚ùå Cancelar
        </a>
    </div>

    <script>
        function enviarPorWhatsapp() {
            // URL completa al PDF
            const pdfUrl = window.location.origin
                + "{{ url_for('entregas.remito_pdf', id_remito=id_remito) }}";
            const text = encodeURIComponent(
                `Hola, te comparto el remito #${{ id_remito }}: ${pdfUrl}`
            );
            // Abre WhatsApp Web/APP con mensaje
            window.open(`https://wa.me/?text=${text}`, "_blank");
        }
    </script>
</body>
</html>
